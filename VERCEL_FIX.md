# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ MIDDLEWARE_INVOCATION_FAILED

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
```
500: INTERNAL_SERVER_ERROR
Code: MIDDLEWARE_INVOCATION_FAILED
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ:

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–∞–π–ª `middleware.ts`

**–ë—ã–ª–æ (–ø—Ä–æ–±–ª–µ–º–Ω–æ–µ):**
```typescript
export const config = {
  matcher: [
    '/',
    '/app',
    '/app/:path*',
    '/(ru|kk|en|pt-BR)/:path*'  // ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å pt-BR
  ]
}
```

**–°—Ç–∞–ª–æ (—Ä–∞–±–æ—á–µ–µ):**
```typescript
export const config = {
  matcher: [
    // Match all pathnames except for
    // - API routes (/api/*)
    // - Static files (_next/*, _vercel/*)
    // - Files with extensions (*.png, *.ico, etc)
    '/((?!api|_next|_vercel|.*\\..*).*)',
  ]
}
```

## üîç –ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫:

1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–µ—Ñ–∏—Å–æ–º –≤ `pt-BR`**: Next.js matcher –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ø–∞—Ç—Ç–µ—Ä–Ω —Å –¥–µ—Ñ–∏—Å–æ–º
2. **API routes –Ω–µ –∏—Å–∫–ª—é—á–µ–Ω—ã**: middleware –≤—ã–∑—ã–≤–∞–ª—Å—è –¥–ª—è `/api/*`, —á—Ç–æ –º–æ–≥–ª–æ –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏
3. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**: middleware –ø—ã—Ç–∞–ª—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª—ã —Ç–∏–ø–∞ `.ico`, `.png`

## üöÄ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ –í—Å–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏: `/ru/*`, `/kk/*`, `/en/*`, `/pt-BR/*`
- ‚úÖ API routes (`/api/*`) –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- ‚úÖ Next.js –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø—É—Ç–∏ (`/_next/*`, `/_vercel/*`) –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (`.png`, `.ico`, `.svg`, etc) –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```bash
git add middleware.ts
git commit -m "Fix middleware matcher for Vercel deployment"
git push origin main
```

### 2. Redeploy –Ω–∞ Vercel:
- Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –ø–æ—Å–ª–µ push
- –ò–ª–∏ –≤—Ä—É—á–Ω—É—é: Dashboard ‚Üí Deployments ‚Üí Redeploy

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–∞–π—Ç –Ω–∞ Vercel
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
  - `/` (–≥–ª–∞–≤–Ω–∞—è)
  - `/ru/` (—Ä—É—Å—Å–∫–∏–π)
  - `/kk/` (–∫–∞–∑–∞—Ö—Å–∫–∏–π)
  - `/en/` (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
  - `/pt-BR/` (–ø–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π)
  - `/app` (–∫–≤–∏–∑)

## ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å!

–û—à–∏–±–∫–∞ `MIDDLEWARE_INVOCATION_FAILED` —Ä–µ—à–µ–Ω–∞.

